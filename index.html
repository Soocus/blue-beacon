<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Blue Beacon Show | Chris Lombardi</title>
    <meta name="description" content="Join The Blue Beacon Show newsletter for exclusive insights, deeper context on current events, and stories that don't make the headlines.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/assets/favicon.png">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@300;400;500;600&family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS (Play CDN - for production, consider building Tailwind locally) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome (with SRI for security) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <!-- Custom Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Montserrat', 'sans-serif'],
                        headline: ['Anton', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            gold: '#C5A059', 
                            dark: '#0a0a0a',
                        }
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                        'fade-in': 'fadeIn 1s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .input-autofill-fix:-webkit-autofill,
        .input-autofill-fix:-webkit-autofill:hover, 
        .input-autofill-fix:-webkit-autofill:focus {
            -webkit-text-fill-color: white;
            -webkit-box-shadow: 0 0 0px 1000px rgba(0,0,0,0.5) inset;
            transition: background-color 5000s ease-in-out 0s;
        }

        /* Mobile viewport fix - accounts for mobile browser chrome */
        @supports (height: 100dvh) {
            .min-h-screen-safe {
                min-height: 100dvh;
            }
        }
        @supports not (height: 100dvh) {
            .min-h-screen-safe {
                min-height: 100vh;
            }
        }
    </style>
</head>
<body class="bg-black text-white antialiased min-h-screen-safe flex flex-col relative font-sans overflow-x-hidden">

    <!-- Background Image with Overlay -->
    <div class="fixed inset-0 z-0">
        <!-- Background -->
        <div class="absolute inset-0 bg-cover bg-center bg-no-repeat" 
             style="background-image: url('/assets/background.png');">
        </div>
        <!-- Gradient Overlay -->
        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/80 to-black/60"></div>
    </div>


    <!-- Main Content Area -->
    <main class="relative z-10 flex-grow flex flex-col justify-center items-center px-4 sm:px-6 md:px-8 py-8 w-full max-w-6xl mx-auto text-center">
        
        <!-- Main Headline -->
        <div class="space-y-4 sm:space-y-6 opacity-0 animate-fade-in-up" style="animation-delay: 0.4s;">
            
            <!-- Headline - now wraps properly on mobile -->
            <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-headline font-normal leading-tight sm:leading-none text-white drop-shadow-lg uppercase tracking-wide">
                The Blue Beacon<br class="sm:hidden"> Show
            </h1>

            <p class="max-w-xl mx-auto text-sm sm:text-base md:text-lg text-gray-300 font-light leading-relaxed px-2">
                Join the newsletter for exclusive insights, deeper context on current events, and stories that don't make the headlines.
            </p>
        </div>

        <!-- Subscription Form -->
        <div class="mt-8 sm:mt-10 w-full max-w-md px-2 opacity-0 animate-fade-in-up" style="animation-delay: 0.6s;">
            <form id="subscribeForm" class="relative group">
                <!-- Honeypot field - hidden from real users, bots will fill it -->
                <input type="text" name="website" id="website" style="position:absolute;left:-9999px;top:-9999px;" tabindex="-1" autocomplete="off" aria-hidden="true">
                
                <!-- Desktop: inline layout -->
                <div class="hidden sm:flex items-center border-b-2 border-white/30 transition-all duration-300 focus-within:border-white focus-within:bg-white/5 py-3">
                    <i class="fa-regular fa-envelope text-gray-400 ml-2"></i>
                    <input 
                        type="email" 
                        id="email-desktop"
                        required
                        placeholder="Enter your email address" 
                        class="input-autofill-fix w-full bg-transparent border-none text-white placeholder-gray-500 focus:ring-0 focus:outline-none px-4 py-1 font-sans font-medium text-sm sm:text-base"
                    >
                    <button 
                        type="submit" 
                        class="subscribe-btn px-4 sm:px-6 py-1 text-xs sm:text-sm font-display font-bold tracking-widest uppercase text-white hover:text-gray-300 transition-colors duration-300 whitespace-nowrap"
                    >
                        Subscribe
                    </button>
                </div>
                
                <!-- Mobile: stacked layout -->
                <div class="sm:hidden space-y-4">
                    <div class="flex items-center border-b-2 border-white/30 transition-all duration-300 focus-within:border-white focus-within:bg-white/5 py-3">
                        <i class="fa-regular fa-envelope text-gray-400 ml-2"></i>
                        <input 
                            type="email" 
                            id="email-mobile"
                            required
                            placeholder="Enter your email" 
                            class="input-autofill-fix w-full bg-transparent border-none text-white placeholder-gray-500 focus:ring-0 focus:outline-none px-3 py-1 font-sans font-medium text-base"
                        >
                    </div>
                    <button 
                        type="submit" 
                        class="subscribe-btn w-full py-3 text-sm font-display font-bold tracking-widest uppercase text-white border border-white/30 hover:bg-white/10 transition-all duration-300"
                    >
                        Subscribe
                    </button>
                </div>
                
                <!-- Success/Error Message Container -->
                <div id="formMessage" class="absolute left-0 right-0 mt-3 text-sm hidden font-light tracking-wide text-center"></div>
            </form>
        </div>

    </main>

    <!-- Footer -->
    <footer class="relative z-10 w-full px-4 py-6 sm:px-6 md:px-10 opacity-0 animate-fade-in" style="animation-delay: 0.8s;">
        <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-gray-500 font-sans tracking-wide">
            <p>&copy; 2026 Blue Beacon. All rights reserved.</p>
            
            <!-- Social Icons -->
            <div class="flex gap-6">
                <a href="https://www.youtube.com/@C.Lombardi" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors" aria-label="YouTube">
                    <i class="fa-brands fa-youtube text-lg"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Form Handler Script -->
    <script>
        const form = document.getElementById('subscribeForm');
        const messageDiv = document.getElementById('formMessage');
        const desktopInput = document.getElementById('email-desktop');
        const mobileInput = document.getElementById('email-mobile');
        const allButtons = form.querySelectorAll('.subscribe-btn');
        
        // Sync inputs
        mobileInput.addEventListener('input', () => desktopInput.value = mobileInput.value);
        desktopInput.addEventListener('input', () => mobileInput.value = desktopInput.value);
        
        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            // Get email from whichever input has a value
            const email = (desktopInput.value || mobileInput.value).trim();
            const honeypot = document.getElementById('website').value;
            
            // Validate
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) {
                messageDiv.classList.remove('hidden', 'text-green-400');
                messageDiv.classList.add('text-red-400');
                messageDiv.innerHTML = '<i class="fa-solid fa-exclamation-circle mr-2"></i> Please enter a valid email address.';
                return;
            }
            
            // Show loading state on ALL buttons
            const originalTexts = [];
            allButtons.forEach((btn, i) => {
                originalTexts[i] = btn.innerText;
                btn.innerText = "PROCESSING...";
                btn.disabled = true;
                btn.classList.add('opacity-50', 'cursor-not-allowed');
            });
            
            try {
                const response = await fetch('/api/subscribe', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, website: honeypot }),
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Success
                    messageDiv.classList.remove('hidden', 'text-red-400');
                    messageDiv.classList.add('text-green-400');
                    messageDiv.innerHTML = '<i class="fa-solid fa-check mr-2"></i> Success! Thank you for subscribing to the Blue Beacon newsletter.';
                    
                    // Clear inputs
                    desktopInput.value = '';
                    mobileInput.value = '';
                    allButtons.forEach(btn => btn.innerText = "SUBSCRIBED");
                    
                    // Reset after delay
                    setTimeout(() => {
                        allButtons.forEach((btn, i) => {
                            btn.innerText = originalTexts[i];
                            btn.disabled = false;
                            btn.classList.remove('opacity-50', 'cursor-not-allowed');
                        });
                        setTimeout(() => {
                            messageDiv.classList.add('hidden');
                        }, 5000);
                    }, 3000);
                } else {
                    throw new Error(data.error || 'Subscription failed');
                }
            } catch (error) {
                console.error('Error:', error);
                // Error state
                messageDiv.classList.remove('hidden', 'text-green-400');
                messageDiv.classList.add('text-red-400');
                messageDiv.innerHTML = '<i class="fa-solid fa-exclamation-circle mr-2"></i> ' + (error.message || 'Something went wrong. Please try again.');
                
                allButtons.forEach((btn, i) => {
                    btn.innerText = originalTexts[i];
                    btn.disabled = false;
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                });
            }
        });
    </script>
</body>
</html>
